c	coalescent time with exponential growthc   integrations use Simpsons'rule	CHARACTER*20 FOUT		real xmax,c,exint,N0,N1,N01,N11	common nsimp		write (9,*) 'Output file?'	read(9,*)  FOUT 	OPEN (1,FILE=FOUT)	REWIND 1		write(9,*) 'Number of points for Simpsons Rule?'	read(9,*) nsimp	write(9,*) 'Initial population size?'	read(9,*) N0	write(9,*) 'Growth rate?'	read(9,*) r	write(9,*) 'Time from start of growth?'	read(9,*) t0	write(1,*) 'Number of points for Simpsons Rule=',nsimp	write(1,*) 'Initial population size= ',N0	write(1,*) 'Growth rate= ',r	write(1,*) 'Time from start of growth= ',t0	N1=N0*exp(r*t0)	write(1,*) 'Final population size= ',N1	write(1,*) ''		write(9,*) 'Number of points for Simpsons Rule=',nsimp	write(9,*) 'Initial population size= ',N0	write(9,*) 'Growth rate= ',r	write(9,*) 'Time from start of growth= ',t0	write(9,*) 'Final population size= ',N1	pause		c=2*N1*r	A=exp(1.0/c)/c	xmax=r*t0	r1=1.0/rc	factors for rescaling time to units of 1/r		call integ1(xmax,c,exint)		write(9,*) 'A= ',A,' xmax= ',xmax,' exint= ',exint	write(1,*) 'A= ',A,' xmax= ',xmax,' exint= ',exint	pause		t1=r1*A*exintc	1st component of expected coal time without BGS	    		a2=1.0-exp(0.0-r*t0)	Pnc=exp(-a2/(2*N0*r))	t2=Pnc*(t0+2*N0)c	2nd component of expected coal time without BGS		t3=t1+t2	write(1,*) 'Prob. of no coalescence by t0= ',Pnc	write(1,*) 'Expected coal time without BGS'	write(1,*)  't1= ',t1,' t2= ',t2	write(1,*) 'Mean coalescent time= ',t3	write(1,*)  ''		10	write(9,*) 'B?'	read(9,*) B	if(B.le.0.001) go to 55	write(1,*) 'BGS coefficient= ',B	write(1,*) ''		N01=B*N0	N11=B*N1c	initial and final population sizes adjusted for B	c=2*N11*r	A=exp(1.0/c)/c	call integ1(xmax,c,exint)			t11=r1*A*exintc	1st component of expected coal time without BGS	    		Pnc=exp(-a2/(2*N01*r))	t21=Pnc*(t0+2*N01)c	2nd component of expected coal time without BGS		t31=t11+t21		B1=t31/t3c	apparent B 		write(1,*) 'Prob. of no coalescence by t0= ',Pnc	write(1,*) 't1= ',t11,' t2= ',t21	write(1,*) 'Mean coalescent time= ',t31,' Apparent B= ',B1	write(1,*) ''	go to 1055	end			subroutine integ1(xmax,c,exint)c		uses Simpson's rulec		exponential integral 				real xmax,exint		common nsimp					ans=nsimp		umax=exp(xmax)		DX=(umax-1.0)/ansx		write(9,*) 'ans =',ans,' umax= ',umax,' DX= ',DX				j=0		N1=nsimp+1				do 50 i=1,N1						u=1+(i-1)*DX		u1=u/c		F1=log(u)*exp(0.0-u1)x		write(9,*) 'i= ',i,' u= ',u,' F1= ',F1x		pausec	integrand of exponential integral				if(i.eq.1) then		ai1=F1				go to 50		end if 			if(j.eq.0) then			ai1=ai1+4*F1					j=1			else			ai1=ai1+2*F1			j=0			end if	50		continue				ai1=DX*ai1/3.0		exint=ai1				return		end